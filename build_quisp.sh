#!/bin/bash
set -eux
cd quisp/quisp
/emsdk/upstream/emscripten/em++ -L/root/omnetpp/lib --bind -s ASYNCIFY=1 -s USE_PTHREADS=1 -s PTHREAD_POOL_SIZE=1 -s TOTAL_MEMORY=1GB -s WASM=1 -s FULL_ES2=1 -s USE_WEBGL2=1 -s NO_EXIT_RUNTIME=0  -s EXPORTED_RUNTIME_METHODS=["UTF16ToString","stringToUTF16","ccall","cwrap"] --post-js post.js --preload-file . --preload-file ./networks --preload-file ./channels --preload-file ./modules  --preload-file /root/omnetpp/images@images --preload-file /root/wasm-qtenvrc@.qtenvrc -s DISABLE_EXCEPTION_CATCHING=0  -O3 -Os -g0 -o out/emcc-release//quisp.html -Wl,--whole-archive out/emcc-release//channels/QuantumChannel.o out/emcc-release//modules/dummyModule.o out/emcc-release//modules/Application/Application.o out/emcc-release//modules/Common/Queue.o out/emcc-release//modules/Common/Router.o out/emcc-release//modules/PhysicalConnection/BSA/BellStateAnalyzer.o out/emcc-release//modules/PhysicalConnection/BSA/HoMController.o out/emcc-release//modules/PhysicalConnection/EPPS/EntangledPhotonPairSource.o out/emcc-release//modules/PhysicalConnection/EPPS/SPDC_Controller.o out/emcc-release//modules/QNIC/PhotonicSwitch/PhotonicSwitch.o out/emcc-release//modules/QNIC/StationaryQubit/StationaryQubit.o out/emcc-release//modules/QRSA/ConnectionManager/ConnectionManager.o out/emcc-release//modules/QRSA/HardwareMonitor/HardwareMonitor.o out/emcc-release//modules/QRSA/RealTimeController/RealTimeController.o out/emcc-release//modules/QRSA/RoutingDaemon/RoutingDaemon.o out/emcc-release//modules/QRSA/RuleEngine/RuleEngine.o out/emcc-release//rules/Clause.o out/emcc-release//rules/Condition.o out/emcc-release//rules/example.o out/emcc-release//rules/Rule.o out/emcc-release//rules/RuleSet.o out/emcc-release//rules/actions/Action.o out/emcc-release//rules/actions/DoublePurifyAction.o out/emcc-release//rules/actions/DoubleSelectionAction.o out/emcc-release//rules/actions/DoubleSelectionDualAction.o out/emcc-release//rules/actions/DoubleSelectionDualActionSecond.o out/emcc-release//rules/actions/PurifyAction.o out/emcc-release//rules/actions/RandomMeasureAction.o out/emcc-release//rules/actions/SimultaneousSwappingAction.o out/emcc-release//rules/actions/SwappingAction.o out/emcc-release//test_utils/Gate.o out/emcc-release//test_utils/QNode.o out/emcc-release//test_utils/Simulation.o out/emcc-release//test_utils/StaticEnv.o out/emcc-release//test_utils/UtilFunctions.o out/emcc-release//utils/ComponentProvider.o out/emcc-release//utils/DefaultComponentProviderStrategy.o out/emcc-release//classical_messages_m.o out/emcc-release//PhotonicQubit_m.o   -Wl,--whole-archive   -loppmain -L/root/qtbase/qtbase/lib -L/root/qtbase/qtbase/plugins/platforms -L/root/qtbase/qtbase/plugins/imageformats/ -lqwasm -lQt5Gui -lQt5Core -lQt5Widgets -lQt5PrintSupport -lQt5OpenGL -lQt5EventDispatcherSupport -lQt5FontDatabaseSupport -lqtfreetype -lqgif  -lqtpcre2 -lqtlibpng -lqtharfbuzz -lqjpeg -lqico -loppqtenv -loppenvir -lopplayout  -loppsim -loppnedxml -loppcommon  -lstdc++
